dt = -0.1:0.05:0.1;
t1 = 0.1 + dt;
t2 = 0.2 + dt;
t3 = 0.3 + dt;
t4 = 0.4 + dt;
t5 = 0.6 + dt;

[T2,T1,T5,T4,T3] = ndgrid(t2,t1,t5,t4,t3);
I_T = (T1 == 0);
I_T = I_T | (T2 <= T1);
I_T = I_T | (T3 <= T2);
I_T = I_T | (T4 <= T3);
I_T = I_T | (T5 <= T4);

import_files;
bal = reshape(optimbal,5,5,5,5,5);
bal(I_T) = 0;
I1 = 2:6;
I2 = I1-1;
I3 = I1+1;
q_bal = zeros(7,7,7,7,7);
q_bal(I1,I1,I1,I1,I1) = bal;
I_bal = bal>q_bal(I3,I1,I1,I1,I1);
I_bal = I_bal & (bal>q_bal(I2,I1,I1,I1,I1));
I_bal = I_bal & (bal>q_bal(I1,I3,I1,I1,I1));
I_bal = I_bal & (bal>q_bal(I1,I2,I1,I1,I1));
I_bal = I_bal & (bal>q_bal(I1,I1,I3,I1,I1));
I_bal = I_bal & (bal>q_bal(I1,I1,I2,I1,I1));
I_bal = I_bal & (bal>q_bal(I1,I1,I1,I3,I1));
I_bal = I_bal & (bal>q_bal(I1,I1,I1,I2,I1));
I_bal = I_bal & (bal>q_bal(I1,I1,I1,I1,I3));
I_bal = I_bal & (bal>q_bal(I1,I1,I1,I1,I2));
I_bal = I_bal & (bal>2);

obj = reshape(1./optimobj,5,5,5,5,5);
obj(I_T) = 0;
q_obj = zeros(7,7,7,7,7);
q_obj(I1,I1,I1,I1,I1) = obj;
I_obj = obj>q_obj(I3,I1,I1,I1,I1);
I_obj = I_obj & (obj>q_obj(I2,I1,I1,I1,I1));
I_obj = I_obj & (obj>q_obj(I1,I3,I1,I1,I1));
I_obj = I_obj & (obj>q_obj(I1,I2,I1,I1,I1));
I_obj = I_obj & (obj>q_obj(I1,I1,I3,I1,I1));
I_obj = I_obj & (obj>q_obj(I1,I1,I2,I1,I1));
I_obj = I_obj & (obj>q_obj(I1,I1,I1,I3,I1));
I_obj = I_obj & (obj>q_obj(I1,I1,I1,I2,I1));
I_obj = I_obj & (obj>q_obj(I1,I1,I1,I1,I3));
I_obj = I_obj & (obj>q_obj(I1,I1,I1,I1,I2));
I_obj = I_obj & (obj>1.0);